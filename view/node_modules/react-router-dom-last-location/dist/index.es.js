import{createContext as t,useContext as e,useState as n,useReducer as r,useEffect as o}from"react";import{jsx as a}from"react/jsx-runtime";import{useLocation as l}from"react-router-dom";const c=null,s=t(null),i=()=>Object.assign({},e(s)),p="SET_LAST_LOCATION",u=(t,e)=>e.type===p?e.payload:t;const m=["key","pathname","search","hash"],y=[],O=t=>{const e=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}(t,["state"]);y.push(e)},h=t=>y.some((e=>{return n=t,r=e,m.every((t=>n[t]===r[t]));var n,r})),f=({children:t,watchOnlyPathname:e=!1})=>{const[c,i]=n(null),m=l(),[y,f]=r(u,null),v={lastLocation:y,setLastLocation:t=>{f({type:p,payload:t})}},d=()=>{null===m||m===c||e&&(null==c?void 0:c.pathname)===m.pathname||(!(t=>{var e;return Boolean(null===(e=t.state)||void 0===e?void 0:e.preventLastLocation)})(m)||h(m)?v.setLastLocation(c):O(m))};return o((()=>{d(),i(m)}),[m]),a(s.Provider,Object.assign({value:v},{children:t}))};function v(t){return e=>{const n=i();return a(t,Object.assign({},e,{lastLocation:n}))}}export{s as LastLocationContext,f as LastLocationProvider,c as initialState,i as useLastLocation,v as withLastLocation};
